#Продам душу composer'у, задешево.

Пришла пора осваивать таки composer. Писать все самому малореально. Хотя, определенный успех в этом направлении имеется...

##А что у нас есть?

Итак, есть проект. Большой, в меру красивый. Развивался он долго, трудно, с тестами, бубнами и местами с блекждеком. Из за особенностей развития, в проекте скопились разные тестовые недоразумения, недописаная документация, оказавшиеся не очень то и нужными фенечки, и так далее... все это любовно складывается в гит.

К счастью, проект оказался кому-то нужен. Хотя бы и самому себе. Этому комуто показалось разумным применить часть проекта у себя. Причем, ему не очень то нужен весь, иногда довольно странный, поток сознания, а нужны четко определенные классы проекта, возможно, с кусочком вменяемой документации. И все.

##Чем не устраивает то, что есть сейчас?

Достаточно посмотреть на дистрибуцию пакета twig/twig, чтобы увидеть проблемы слишком простого обращения с композером. Весь устанавливаемый пакет занимает 1.3м, в то время как действительно нужными оказываются только <500к из каталога twig/twig/lib

##Что делать?

У композера не густо с описанием "давай сложим в корзинку вот такие файлы, а все остальное выкинем". Зато композер умеет работать с дистрибутами из архивов. Так что автору проекта достаточно складировать в архив нужные для "библиотеки" файлы и дело в шляпе.

В качестве шляпы возьмем phpStorm, прикрутим к нему phing, pear, нужные классы для задачи `gzip`, и будем собирать наш архив прямо в проекте, подкладывая его в тот же гит.

###Лирическое отступление

В шторме есть довольно удачный механизм скриптовой обработки - phing. К сожалению, для нормальной работы этого самого механизма нужен pear и некоторые дополнительные прибамбасы. Опять же к сожалению, разумно работать с встроенными в шторм возможностьями на загрузке phar-пакетов не представляется возможным. Подгруженные phar отказываются работать как надо, так как нужные задачи постоянно недозагружены в пакеты злодеями -разработчиками...
Однако, нам поможет тот же композер.

Стряпаем в отдельном месте нашего компьютера каталог pear, размещаем в нем файл composer.json

    {
        "repositories": [
            {
                "type": "pear",
                "url": "http://pear.php.net"
            }
        ],
        "require": {
            "phing/phing" : "2.6.1",
            "pear-pear.php.net/pear": "*",
            "pear/archive_tar" : "1.3.11"
        }
    }

Пишем в командной строке `composer update` и, через несколько минут, у нас появится почти нормальный pear с почти нормальным phing'ом. Почти - это если у вас как и у меня, php не находится в пути доступа. В этом случае необходимо поправить файл
`vendor\phing\phing\bin\phing.bat` и поставить туда что-то вроде

    set PHP_COMMAND=d:\Winginx\php54\php.exe

Все! Указываем в настройках шторма `Phing->Path to Phing executable` этот самый файл и все должно зажить...